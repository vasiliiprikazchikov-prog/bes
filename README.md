## Приказчиков Василий УИБО-13-24
## Выполнение контрольной работы

## Задание 1. SQL-injection и логин с административными правами
Задание 1. SQL-injection и логин с административными правами
При вводе значка ' в поле логин и случаного пароля получаем непонятный  ответ. 
<img width="1500" height="924" alt="изображение" src="https://github.com/user-attachments/assets/0b85e45e-5eed-4615-94d1-63a978ee87ab" />
Это означает что база данных пользователей реализована с уязвимостями
Ввод ' or 1=1;-- в поле логин и случаного пароля позволили залогиниться по пользователем admin@juice-sh.op. Наверно, что это администратор. 
<img width="1822" height="367" alt="изображение" src="https://github.com/user-attachments/assets/b70cef98-382e-42f0-923b-b3de4ebb5034" />

## Ответы на вопросы
1. Что такое SQL инъекция?
SQL инъекция — это уязвимость веб-приложений, которая позволяет злоумышленнику внедрять и выполнять произвольные SQL-команды в базе данных приложения. Это происходит, когда приложение некорректно обрабатывает пользовательский ввод, не выполняя его должную проверку и экранирование, что позволяет модифицировать исходную логику SQL-запросов.

2. Почему ввод строки ' or 1=1;-- позволил войти в аккаунт администратора?
Данная строка нарушает исходную логику SQL-запроса, предназначенного для проверки учетных данных. Конструкция ' разрывает строковый литерал в условии, оператор OR 1=1 делает всё условие запроса всегда истинным, а символы ;-- завершают текущую команду и комментируют оставшуюся часть исходного запроса, включая проверку пароля. В результате база данных возвращает первую запись из таблицы пользователей, которой часто является запись администратора.

3. Как защитить web-ресурс от подобного рода атак?
Основные меры защиты включают:
 Использование параметризованных запросов или подготовленных выражений, которые отделяют данные от кода команды.
 Строгую валидацию и санацию всех пользовательских данных.
 Соблюдение принципа наименьших привилегий для учетных записей, используемых приложением для доступа к базе данных.
 Регулярное обновление и патчинг систем управления базами данных и frameworks.
 Проведение регулярного аудита безопасности и тестирования на проникновение.

## Задание 2. Узнайте пароль администратора
Находясь после SQL под логином администратора - включаем DevTools и обновляем страницу OWAS Juice. Переходим в запрос домена - и находим заголовок кукис. Находим IDTOKEN 
<img width="1920" height="1080" alt="изображение" src="https://github.com/user-attachments/assets/c1440e1b-8100-4a61-80ae-35529d65f29c" />
Копируем его Декодируем онлайн с помощью ИИ. Получаем результат:
<img width="1013" height="883" alt="изображение" src="https://github.com/user-attachments/assets/53501121-7036-4c2b-a493-d27b6c6127d0" />
ХЭШ "password": "0192023a7bbd73250516f069df18b500",используем онлайн инструмент для подборки пароля
<img width="1868" height="821" alt="изображение" src="https://github.com/user-attachments/assets/2c27e56b-ae10-42dc-82dd-6c4a160b543a" />
Пароль:admin123

Исходя из анализа кода Ключеве поля:
status: "success" — операция аутентификации прошла успешно.
id: 1 — уникальный идентификатор администратора.
email: "admin@juice-sh.op"
password: "0192023a7bbd73250516f069df18b500" — MD5-хэш пароля "admin123".
role: "admin" — роль пользователя — администратор.
isActive: true — учётная запись активна.
createdAt: "2025-12-05 08:35:46.289 +00:00" — дата создания аккаунта.
iat (issued at): 1764927906 — время выдачи токена в формате Unix-времени (4 декабря 2025, ~10:45:06 UTC).

# Ответы на вопросы
### 1. Какой логин у администратора?
admin@juice-sh.op
### 2. Какой хэш пароля у администратора? 
Хэш "password": "0192023a7bbd73250516f069df18b500"
### 3. Какой пароль администратора?
Пароль: admin123
### 4. Что такое cookie?
**Cookie — это небольшие текстовые файлы, которые веб-сайты сохраняют в вашем браузере для запоминания информации о вас.** Они позволяют сайтам узнавать вас при повторных посещениях и сохранять данные like логин, настройки или содержимое корзины покупок. Без cookie сайты не могли бы запомнить, что вы уже вошли в аккаунт, и вам пришлось бы авторизоваться заново при каждом переходе на новую страницу.
### 5. Какие меры могут быть использованы для устранения выявленной уязвимости?
Для устранения уязвимости, необходимо немедленно исключить любые чувствительные данные (включая хэши паролей) из полезной нагрузки JWT, оставив только минимальные идентификаторы (например, userId и роль), реализовать короткое время жизни токенов в сочетании с системой безопасного обновления через refresh-токены, хранящиеся в защищенных куках с флагами HttpOnly, Secure и SameSite=Strict, использовать асимметричные алгоритмы подписи (например, RS256), регулярно проводить ротацию ключей подписи и обеспечивать строгую валидацию токенов на стороне сервера перед предоставлением доступа к любым ресурсам.

## Задание 3. «Чужая корзина»
открыл свою карзину 
<img width="1012" height="553" alt="изображение" src="https://github.com/user-attachments/assets/03b1e7f6-91e4-4a2a-b6b3-82246e7f0860" />

Начал изменять количество товаров, вижу что меняется itemtotal Предпологаю что bid это индентификатор, изменяю число bid на 3 вижу что корзина меняется и остается такой же при перезагрузке страницы, корзина изменена на корзину другого пользователя 
<img width="1011" height="544" alt="изображение" src="https://github.com/user-attachments/assets/1618821b-1f45-4b52-aee5-5128fa7fbdc3" />
## Решение задания
1. Наименование параметра, который отвечает за открываемую корзину.
BID
2. Ваши рекомендации по исправлению этой незначительной уязвимости
Для устранения данной уязвимости необходимо реализовать строгую привязку сессионной корзины к конкретному пользователю, проверяя перед любыми изменениями (добавлением, изменением, удалением товаров), что идентификатор текущего аутентифицированного пользователя совпадает с идентификатором владельца корзины в сессии, а также исключить возможность передачи или изменения идентификатора корзины (BID) через клиентскую часть (например, скрытые поля форм, параметры URL или API-запросы), генерируя и используя уникальный, криптографически стойкий идентификатор сессии на сервере для каждой новой пользовательской сессии.
## Задание 4. XSS-инъекция
Ввожу в поле поиска <h1>owasp<h1> для проверки возможности XSS-инъекция
<img width="1007" height="544" alt="изображение" src="https://github.com/user-attachments/assets/85d6b85b-0472-4607-a950-5c701b875c86" />
Видим что успешно создался элемент, можно попробовать что-то более интересное например <a href="javascript:alert('XSS');">Click me</a>
<img width="1012" height="544" alt="изображение" src="https://github.com/user-attachments/assets/3f6319a1-13f0-429d-9ad4-c9eae36243ea" />
При нажатии Click Me можно вызвать уведомление тем самым злоумышленники смогут воспользоваться этим делаю ссылки на вирусы и т.д



